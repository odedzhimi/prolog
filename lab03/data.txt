% Авторское право

домен(genre) = развлекательный; научный; бытовой; новостной; спортивный.

факт(publications:журнал(цел, строка, genre, цел)).
факт(publications:газета(цел, строка, genre, цел)).
факт(publications:подписчик(цел, строка, цел, строка)).
факт(publications:подписан(цел, цел)).

предикат(длина(список) -> цел).
предикат(сумма_элем(список) -> вещ).
предикат(среднее_списка(список) -> вещ).

предикат(читает(строка) -> список).
предикат(подписчикиИздания(строка) -> список).
предикат(суммаПоЖанру(genre) -> вещ).
предикат(жанр(genre) -> список).
предикат(доставка(строка) -> список).
предикат(издание(цел, строка, genre, цел)).
предикат(колвоЛюдей(genre) -> цел).
предикат(средЦена(genre) -> вещ).
предикат(write_string(список)).

правило(длина([], 0)).
правило(длина([_ | T], N) :- длина(T, N1), N = N1 + 1).

правило(сумма_элем([], 0)).
правило(сумма_элем([H | T], Sum) :- сумма_элем(T, Sum1), Sum = Sum1 + H).

правило(среднее_списка(L, Average) :- сумма_элем(L, Sum), длина(L, Length), Average = Sum / Length, Length > 0).

правило(издание(A, Б, В, Г) :- журнал(A, Б, В, Г)).
правило(издание(A, Б, В, Г) :- газета(A, Б, В, Г)).

правило(читает(Имя, List) :- findall(Название, (подписчик(НомерП, Имя, _, _), подписан(НомерП, НомерИ), издание(НомерИ, Название, _, _)), List)).

правило(подписчикиИздания(Название, List) :- findall(Имя, (издание(НомерИ, Название, _, _), подписан(НомерП, НомерИ), подписчик(НомерП, Имя, _, _)), List)).

правило(суммаПоЖанру(Жанр, Sum) :- findall(Цена, издание(_, _, Жанр, Цена), Prices), сумма_элем(Prices, Sum)).

правило(жанр(Жанр, List) :- findall(Имя, (издание(Id_издания, _, Жанр, _), подписан(Id_подписчика, Id_издания), подписчик(Id_подписчика, Имя, _, _)), List)).

правило(доставка(Название, List) :- findall(Адрес, (издание(Id_издания, Название, _, _), подписан(Id_подписчика, Id_издания), подписчик(Id_подписчика, _, _, Адрес)), List)).

правило(колвоЛюдей(Жанр, N) :- жанр(Жанр, List), длина(List, N)).

правило(средЦена(Жанр, Sred) :- findall(Цена, издание(_, _, Жанр, Цена), Prices), среднее_списка(Prices, Sred)).

правило(write_string(L) :- foreach member(Элемент, L) do write(Элемент, '; ') end foreach, write('\n')).

